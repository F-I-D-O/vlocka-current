<?phprequire_once 'funkce.php';$chybova_zprava = "neznámá chyba";/** otestuje zda bylo zadáno jméno, pokud zadáno nebylo, přihlašování skončí* a zobrazí se chybová hláška.*/if(!$_POST["login"] || trim($_POST["login"]) == ""){	posledni_strana1("chyba prihlaseni=nezadali jste svůj nick", 0);	exit;}/** otestuje zda bylo zadáno heslo, pokud zadáno nebylo, přihlašování skončí * a zobrazí se chybová hláška.*/if(!$_POST["heslo"] || trim($_POST["heslo"]) == ""){	posledni_strana1("chyba prihlaseni=nezadali jste svoje heslo", 0);	exit;}/* * Připojení k databázi MySQL - v případě neúspěchu se objeví  * chybové hlášení a činnost aplikace se ukončí */$databaze = new databaze(); session_start();odstran_lomitka($_POST);zkus_prihlaseni($_POST, $databaze);function zkus_prihlaseni($formdata, $databaze){	$login = $_POST["login"];	$heslo = $_POST["heslo"];  	$sql = "SELECT ID, role, profilID FROM uzivatele     	WHERE nick = " . $databaze->uprav_na_sql($login) .     	" AND heslo = UNHEX(SHA1(" . $databaze->uprav_na_sql($heslo . $login) .     	")) AND aktivni = 1";		//pole s daty načtenými z databáze	$radek = $databaze->queryObject($sql);  	if($radek) {	    //nastaví proměnné relace		$_SESSION['ID'] = $radek->ID;			    $_SESSION['login'] = $login;	    $_SESSION['role'] = $radek->role;	    $_SESSION['profilID'] = $radek->profilID;	      	    //přesměrování	   	posledni_strana0();	    exit;	}	else{    	posledni_strana1("chyba prihlaseni=Špatné jméno nebo heslo");	}}?>